var tempFiles,handleFiles,resultContainer=$(".result-container div[contenteditable]"),isFileReaderSupported=function(){return"FormData"in window&&"FileReader"in window},isInputDirSupported=function(){var t=document.createElement("input");return"webkitdirectory"in t||"mozdirectory"in t||"odirectory"in t||"msdirectory"in t||"directory"in t},isDragSupported=function(){var t=document.createElement("div");return"draggable"in t||"ondragstart"in t&&"ondrop"in t},dropZone=$(".dropzone"),dropForm=$(".dropform");isFileReaderSupported()||console.log("filereader not supported"),isInputDirSupported()||console.log("inputdir not supported"),isDragSupported()||console.log("dragging not supported");var printDirectory=function(t,r){function e(t,a){o==t+"/"?0==$('ul[data-path="'+o+'"]').length&&(r.append('<ul data-directory="'+t+'" data-path="'+o+'"></ul>'),targetUl=$('ul[data-path="'+o+'"]')):0==$('ul[data-path="'+o+'"]').length&&(targetUl.append('<li class="directory"><span class="directory-name">'+t+'</span><ul data-directory="'+t+'" data-path="'+o+'"></ul></li>'),targetUl=$('ul[data-path="'+o+'"]'));for(var i in a)"object"==$.type(a[i])?(o+=i+"/",e(i,a[i]),o=o.substring(o.length-i.length-1,-1),targetUl=$('ul[data-path="'+o+'"]')):targetUl.append('<li class="file">'+i+"</li>")}for(var a in t)if("timestamp"!=a){var i=t[a],n=a;r.prepend('<span class="directory-title">Directory List of '+a+":</span></br>"),resultContainer.prepend('<span>Legend:</span></br><ul><li>circle: file</li><li class="directory">square: directory</li></ul></br>')}else r.prepend('<span class="timestamp">Scan Time:</span></br>'+t[a]+"</br></br>");var o=n+"/";e(n,i)},createDirectoryArray=function(t){var r=new Date;if(t){t.sort();var e=t[0].split("/"),a={};a[e=e[0]]={},a.timestamp=r;for(var i=a,n=[e],o=0;o<t.length;o++){var d=t[o].split("/");n=d;for(var l=d.pop(),s=0;s<n.length;s++)key=n[s].toString(),i[key]||(i[key]={}),i=i[key];i[l]=l,i=a,n}return a}return console.log("no file-paths found"),!1};isFileReaderSupported()&&isInputDirSupported()&&isDragSupported()?(dropForm.addClass("has-advanced-upload"),$("#file").on("change",function(t){var r=t.target.files,e=r[0].webkitRelativePath;e=(e=e.split("/"))[0],dropForm.addClass("has-directory"),dropForm.find(".selected-folder .folder-name").text(e.substring(0,$(this).width()/20)+"â€¦");for(var a=new Array,i=0;i<r.length;i++)a.push(r[i].webkitRelativePath);var n=createDirectoryArray(a);resultContainer.text(""),console.log(n),printDirectory(n,resultContainer),""!=resultContainer.text?resultContainer.parent().attr("data-visibility","visible"):(resultContainer.parent().attr("data-visibility","hidden"),dropForm.removeClass("has-directory"))})):$("body").addClass("not-supported"),resultContainer.on("focusout",function(){""==$(this).text()&&($(this).parent().attr("data-visibility","hidden"),dropForm.removeClass("has-directory"))});